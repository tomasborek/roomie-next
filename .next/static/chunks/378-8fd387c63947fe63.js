"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[378],{378:function(e,t,n){var s=n(5893),i=n(7294),a=(n(2882),n(7227));function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function l(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}t.Z=function(e){var t=e.object,n=e.setObject,r=e.listingImgs,o=e.addedListingImgs,u=e.setAddedListingImgs,f=(e.addedPfp,e.setAddedPfp),c=e.pfp,d=(0,i.useState)(null),g=d[0],m=d[1],p=(0,i.useRef)(null);return(0,s.jsx)(a.Z,{sx:{color:"#fff",zIndex:function(e){return e.zIndex.drawer+1}},open:t.open,children:(0,s.jsxs)("div",{className:"gallery-input",children:[(0,s.jsx)("i",{onClick:function(){n({open:!1,index:0}),m(null),p.current.value=""},className:"input-close fas fa-times"}),(0,s.jsx)("div",{className:"input-heading",children:"Vlo\u017eit novou fotografii"}),g?(0,s.jsx)("img",{className:"input-img",src:URL.createObjectURL(g),alt:""}):(0,s.jsxs)(s.Fragment,{children:[-1===t.index&&(0,s.jsx)(s.Fragment,{children:c?(0,s.jsx)("img",{src:c,className:"input-img"}):(0,s.jsx)("div",{className:"input-img"})}),t.index>-1&&(0,s.jsx)(s.Fragment,{children:r&&r[t.index]?(0,s.jsx)("img",{src:r[t.index],className:"input-img"}):(0,s.jsx)("div",{className:"input-img"})})]}),g&&(0,s.jsxs)("p",{className:"input-status",children:["Soubor byl nahr\xe1n! (",g.name.substring(0,10),")"]}),(0,s.jsx)("input",{accept:".png, .jpg",ref:p,type:"file",onChange:function(e){m(e.target.files[0])}}),(0,s.jsx)("button",{disabled:!g,onClick:function(){return function(){if(-1===t.index&&g&&f(g),t.index>-1){var e=l(o);e[t.index]=g,u(e)}n({open:!1,index:-1}),m(null),p.current.value=""}()},className:"main-btn input-btn ".concat(!g&&"disabled"),children:"Hotovo"})]})})}},2882:function(e,t,n){n.d(t,{u:function(){return b},a:function(){return h}});var s=n(5893),i=n(7294),a=n(387),r=n(6934),l=n(1018),o=n(5182),u=n(7503),f=n(1614),c=n(742);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},s=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),s.forEach((function(t){g(e,t,n[t])}))}return e}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var s,i,a=[],r=!0,l=!1;try{for(n=n.call(e);!(r=(s=n.next()).done)&&(a.push(s.value),!t||a.length!==t);r=!0);}catch(o){l=!0,i=o}finally{try{r||null==n.return||n.return()}finally{if(l)throw i}}return a}}(e,t)||S(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||S(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}var v=(0,i.createContext)(),b=function(){return(0,i.useContext)(v)},h=function(e){var t=e.type,n=e.ssrProps,d=e.cr,S=e.children,b=(0,a.useRouter)(),h=b.query.id,I=(0,r.s)(),x=I.getListing,T=I.getUser,j=I.getListingContact,B=(0,l.a)(),P=B.currentUser,O=B.currentUserInfo,L=B.userLoaded,N=p((0,o.r)(),2),A=(N[0],N[1]),F=(0,u.i)().snackBar,w=(0,f.d)().callable,U=(0,c.y)().uploadImg,k=(0,i.useState)(null),J=k[0],R=k[1],C=(0,i.useState)(d),E=C[0],q=C[1],z=(0,i.useState)(h),D=z[0],M=z[1],Z=(0,i.useState)(n.listingImgs),G=Z[0],_=Z[1],$=(0,i.useState)(n.listingPfp),H=$[0],V=$[1],W=(0,i.useState)(n.listingName),K=W[0],Q=W[1],X=(0,i.useState)(n.listingUsername),Y=X[0],ee=X[1],te=(0,i.useState)(n.listingAge),ne=te[0],se=te[1],ie=(0,i.useState)(n.listingGender),ae=ie[0],re=ie[1],le=(0,i.useState)("flatmate"===t?n.listingBio:null),oe=le[0],ue=le[1],fe=(0,i.useState)("flat"===t?n.listingFlatBio:null),ce=fe[0],de=fe[1],ge=(0,i.useState)("flat"===t?n.listingPersonBio:null),me=ge[0],pe=ge[1],ye=(0,i.useState)(JSON.parse(n.listingPersonBoxes)),Se=ye[0],ve=ye[1],be=(0,i.useState)(JSON.parse(n.listingPersonTags)),he=be[0],Ie=be[1],xe=(0,i.useState)("flat"===t?JSON.parse(n.listingFlatBoxes):null),Te=xe[0],je=xe[1],Be=(0,i.useState)("flatmate"===t?JSON.parse(n.listingFlatTags):null),Pe=Be[0],Oe=Be[1],Le=(0,i.useState)(n.listingPremium),Ne=Le[0],Ae=Le[1],Fe=(0,i.useState)(n.listingFans?n.listingFans:[]),we=Fe[0],Ue=Fe[1],ke=(0,i.useState)(!1),Je=ke[0],Re=ke[1],Ce=(0,i.useState)(null),Ee=Ce[0],qe=Ce[1],ze=(0,i.useState)(null),De=ze[0],Me=ze[1],Ze=(0,i.useState)(null),Ge=Ze[0],_e=Ze[1],$e=(0,i.useState)(null),He=$e[0],Ve=$e[1],We=(0,i.useState)(!1),Ke=We[0],Qe=We[1],Xe=(0,i.useState)(!1),Ye=Xe[0],et=Xe[1],tt=(0,i.useState)(!1),nt=tt[0],st=tt[1],it=(0,i.useState)(!1),at=it[0],rt=it[1],lt=(0,i.useState)(!1),ot=lt[0],ut=lt[1],ft=(0,i.useState)(!1),ct=ft[0],dt=ft[1],gt=(0,i.useState)(!1),mt=gt[0],pt=gt[1],yt=(0,i.useState)(!1),St=yt[0],vt=yt[1],bt=(0,i.useState)(""),ht=bt[0],It=bt[1],xt=(0,i.useState)(""),Tt=xt[0],jt=xt[1],Bt=(0,i.useState)(!0),Pt=Bt[0],Ot=Bt[1],Lt=(0,i.useState)({open:!1,type:"none",img:null,index:0}),Nt=Lt[0],At=Lt[1],Ft=(0,i.useState)(["","","","","",""]),wt=Ft[0],Ut=Ft[1],kt=(0,i.useState)(null),Jt=kt[0],Rt=kt[1],Ct=(0,i.useState)(null),Et=Ct[0],qt=Ct[1],zt=(0,i.useState)(null),Dt=zt[0],Mt=zt[1],Zt=(0,i.useState)(null),Gt=Zt[0],_t=Zt[1],$t=(0,i.useState)(null),Ht=$t[0],Vt=$t[1],Wt=(0,i.useState)(null),Kt=Wt[0],Qt=Wt[1],Xt=(0,i.useState)(null),Yt=Xt[0],en=Xt[1],tn=(0,i.useState)(null),nn=tn[0],sn=tn[1],an=w("userUpdates-updateListing"),rn=w("requests-createRequest"),ln=w("images-deleteImgs"),on=(w("userUpdates-likeListing"),w("userUpdates-unlikeListing"),w("feedback-reportUser"));(0,i.useEffect)((function(){b.isReady&&L&&cn()}),[b.isReady,h,P,L]),(0,i.useEffect)((function(){null!=n.listingPersonTags&&null===he&&("success"===n.status?fn():"client-side"===n.status&&gn())}),[n]),(0,i.useEffect)((function(){J&&E&&("flatmate"===t&&(Qt(oe),Ve(J.mainInfo.budget),_t(Se),qt(he),Mt(Pe)),"flat"===t&&(sn(me),en(ce),Ve(J.mainInfo.price),_t(Se),Vt(Te),qt(he)),Me(J.mainInfo.stayTime),_e(J.mainInfo.startTime))}),[E,J]),(0,i.useEffect)((function(){L&&!P&&q(!1)}),[P]),(0,i.useEffect)((function(){E||(qt(null),Mt(null),_t(null),Vt(null),Ut(["","","","","",""]),Rt(null))}),[E]),(0,i.useEffect)((function(){P&&we&&we.includes(P.uid)?Re(!0):Re(!1)}),[we,P]);var un,fn=function(){Q(n.listingName),ee(n.listingUsername),se(n.listingAge),re(n.listingGender),V(n.listingPfp),_(n.listingImgs),ue("flatmate"===t?n.listingBio:null),de("flat"===t?n.listingFlatBio:null),pe("flat"===t?n.listingPersonBio:null),ve(JSON.parse(n.listingPersonBoxes)),Ie(JSON.parse(n.listingPersonTags)),je("flat"===t?JSON.parse(n.listingFlatBoxes):null),Oe("flatmate"===t?JSON.parse(n.listingFlatTags):null),Ae(n.listingPremium),Ue(n.listingFans)},cn=function(){A(!1),R(null),"success"!=n.status&&"client-side"!=n.status||("client-side"!==n.status||P)&&(fn(),d&&vt(!0),"client-side"!==n.status?(R(JSON.parse(n.listingInfo)),M(h),P&&(n.listingFriends.includes(P.uid)||P.uid===n.uid)?j(h).then((function(e){qe(e.docs[0].data()),Ot(!1)})).catch((function(e){})):L&&Ot(!1)):gn())},dn=function(){Ot(!0),ut(!1);var e=J;T(P.uid).then((function(t){var n={sender:t.data(),senderUid:t.id,reciever:e.userInfo,recieverListingId:D,recieverUid:e.userInfo.uid,recieverType:e.type,message:ht};return rn(JSON.stringify(n))})).then((function(e){return x(h)})).then((function(e){R(e.data()),Ot(!1),F("\u017d\xe1dost byla odesl\xe1na.","success")})).catch((function(e){A(!1),ut(!0),F("N\u011bco se nepovedlo. Zkuste to pros\xedm pozd\u011bji.","error")}))},gn=function(){x(h).then((function(e){var n,s=e.data();if(n=s.userInfo.uid,P&&P.uid===n)return R(s),M(e.id),_(s.userInfo.images.listingImgs),s.userInfo.images.pfp&&V(s.userInfo.images.pfp),Q("flatmate"===t?s.userInfo.username:"".concat(s.flatBoxes.layout).concat(s.flatBoxes.layout?" ":"").concat(s.flatBoxes.location)),ee(s.userInfo.username),se(s.userInfo.age),re(s.userInfo.gender),ue("flatmate"===t&&s.bio),de("flat"===t&&s.flatBio),pe("flat"===t&&s.personBio),ve(s.personBoxes),Ie(s.personTags),je("flat"===t&&s.flatBoxes),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Oe("flatmate"===t&&s.flatTags),Ae(s.userInfo.premium),j(h)})).then((function(e){qe(e.docs[0].data()),Ot(!1)})).catch((function(e){}))},mn=(g(un={type:t,cr:d,listingInfo:J,setListingInfo:R,editListing:E,setEditListing:q,listingId:D,setListingId:M,listingImgs:G,setListingImgs:_,pfp:H,setPfp:V,listingName:K,setListingName:Q,listingUsername:Y,setListingUsername:ee,listingAge:ne,setListingAge:se,listingGender:ae,setListingGender:re,listingBio:oe,setListingBio:ue,listingFlatBio:ce,setListingFlatBio:de,listingPersonBio:me,setListingPersonBio:pe,listingPersonBoxes:Se,setListingPersonBoxes:ve,listingPersonTags:he,setListingPersonTags:Ie,listingFlatBoxes:Te,setListingFlatBoxes:je,listingFlatTags:Pe,setListingFlatTags:Oe,listingPremium:Ne,setListingPremium:Ae,listingFans:we,setListingFans:Ue,listingLiked:Je,setListingLiked:Re,stayTime:De,setStayTime:Me,startTime:Ge,setStartTime:_e,budget:He,setBudget:Ve,personTagOverlay:Ke,setPersonTagOverlay:Qe,flatTagOverlay:Ye,setFlatTagOverlay:et,flatBoxerOverlay:nt,setFlatBoxerOverlay:st,personBoxerOverlay:at,setPersonBoxerOverlay:rt,reqDialogOpen:ot,setReqDialogOpen:ut,reportDialog:ct,setReportDialog:dt,sliderDialog:mt,setSliderDialog:pt,requestMessage:ht,setRequestMessage:It,reportMessage:Tt,setReportMessage:jt,contactLoading:Pt,setContactLoading:Ot,welcomeDialog:St,setWelcomeDialog:vt,galleryInput:Nt,setGalleryInput:At,addedListingImgs:wt,setAddedListingImgs:Ut,addedPfp:Jt,setAddedPfp:Rt,addedPersonTags:Et,setAddedPersonTags:qt,addedFlatTags:Dt,setAddedFlatTags:Mt,addedPersonBoxes:Gt,setAddedPersonBoxes:_t,addedFlatBoxes:Ht,setAddedFlatBoxes:Vt,bio:Kt,setBio:Qt,flatBio:Yt,setFlatBio:en,personBio:nn,setPersonBio:sn,reloadProps:fn,handleSave:function(){if(A(!0),!De||""==De)return F("Pros\xedme vypl\u0148te v\u0161echny d\u016fle\u017eit\xe9 \xfadaje.","error"),A(!1),void window.scrollTo(0,0);if(!Ge||""==Ge)return F("Pros\xedme vypl\u0148te v\u0161echny d\u016fle\u017eit\xe9 \xfadaje.","error"),A(!1),void window.scrollTo(0,0);if(!He||He<1e3||He>6e4)return F("Pros\xedm zadejte spr\xe1vnou hodnotu do ".concat("flatmate"===J.type?"rozpo\u010dtu.":"n\xe1jemn\xe9ho.")),A(!1),void window.scrollTo(0,0);var e;"flatmate"!==t&&"flatmate-cr"!==t||(e={mainInfo:{budget:He,startTime:Ge,stayTime:De},personBoxes:Gt,personTags:Et,flatTags:Dt,bio:Kt?Kt.trim():"",visible:!0},Gt.job&&(e=m({},e,{"queryInfo.job":{employed:"Zam\u011bstnan\xfd"===Gt.job,unemployed:"Nezam\u011bstnan\xfd"===Gt.job,student:"Student"===Gt.job}}))),"flat"!==t&&"flat-cr"!==t||(e={mainInfo:{price:He,startTime:Ge,stayTime:De},personTags:Et,personBoxes:Gt,flatBoxes:Ht,flatBio:Yt?Yt.trim():"",personBio:nn?nn.trim():"",visible:!0},Gt.job&&(e=m({},e,{"queryInfo.job":{employed:"Zam\u011bstnan\xfd"===Gt.job,unemployed:"Nezam\u011bstnan\xfd"===Gt.job,student:"Student"===Gt.job}})));var n={listingId:D,params:e};an(JSON.stringify(n)).then((function(e){return Jt?U(P.uid,Jt,"pfp"):Promise.resolve("No new pfp")})).then((function(e){return wt.length?U(P.uid,wt,"listingImgs"):Promise.resolve("No new imgs")})).then((function(e){return window.scrollTo({top:0,behavior:"smooth"}),d?(F("Inzer\xe1t byl \xfasp\u011b\u0161n\u011b vytvo\u0159en.","success"),b.push("/".concat(J.type,"/").concat(D)),Promise.resolve("response")):(A(!1),R(null),ue(null),de(null),pe(null),ve(null),Ie(null),je(null),Oe(null),q(!1),F("Inzer\xe1t byl \xfasp\u011b\u0161n\u011b upraven.","success"),b.push(b.asPath),x(D))})).then((function(e){d||R(e.data())})).catch((function(e){A(!1),F("N\u011bco se pokazilo. Zkuste to pros\xedm pozd\u011bji.","error")}))},handleRequest:dn,handleReport:function(){var e=J.userInfo.uid,t=Y,n=Tt,s=P.uid,i=null;O&&(i=O.mainInfo.username);var a={uid:e,username:t,message:n,listingId:D,senderUid:s,senderUsername:i};on(JSON.stringify(a))},handleImgDelete:function(e){if("pfp"===e){if(Jt)return void Rt(null);A(!0);var t={url:H,uid:P.uid,listingId:D};ln(JSON.stringify(t)).then((function(e){V(null),A(!1)})).catch((function(e){A(!1)}))}if("main"===e){if(wt[0]){var n=y(wt);return n[0]="",void Ut(n)}A(!0);var s={url:G[0],uid:P.uid,listingId:D};ln(JSON.stringify(s)).then((function(e){var t=y(G);t[0]="",_(t),A(!1)})).catch((function(e){A(!1)}))}},loadClientSide:gn},"handleRequest",dn),g(un,"listingContact",Ee),un);return(0,s.jsx)(v.Provider,{value:mn,children:S})}}}]);