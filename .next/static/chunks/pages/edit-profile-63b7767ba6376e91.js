(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[46],{1128:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/edit-profile",function(){return n(3118)}])},3118:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var a=n(5893),r=n(7294),s=n(387),i=n(9008),l=n(1018),c=n(6934),o=n(5182),d=n(1614),u=n(7503),m=n(742),h=n(1681),f=n(5906),p=function(e){var t=e.activeRider,n=e.setActiveRider;return(0,a.jsx)("div",{onClick:function(){return n((function(e){return!e}))},className:"switcher",children:(0,a.jsx)(f.E.div,{variants:{active:{left:0,backgroundColor:"#309EAB"},disabled:{right:0,backgroundColor:"#E14949"},transition:{duration:.2}},animate:t?"active":"",initial:"disabled",transition:"transition",className:"switcher-rider",children:(0,a.jsx)(f.E.i,{animate:t?{rotate:"360deg"}:"",transition:{duration:.4},className:"fas fa-".concat(t?"check":"times")})})})},v=n(3300),j=n(378),x=n(8456),N=n(1587),g=n(1425),b=n(6580),y=n(3366),k=n(7462),Z=n(7192),w=n(2151),C=n(7623),P=n(8862),S=n(3620);function R(e){return(0,S.Z)("MuiDialogContentText",e)}(0,n(6087).Z)("MuiDialogContentText",["root"]);const z=["children"],E=(0,w.ZP)(P.Z,{shouldForwardProp:e=>(0,w.FO)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({});var I=r.forwardRef((function(e,t){const n=(0,C.Z)({props:e,name:"MuiDialogContentText"}),r=(0,y.Z)(n,z),s=(e=>{const{classes:t}=e,n=(0,Z.Z)({root:["root"]},R,t);return(0,k.Z)({},t,n)})(r);return(0,a.jsx)(E,(0,k.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:r},n,{classes:s}))})),A=n(7645),U=n(3321),_=n(5568);function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,s=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(s.push(a.value),!t||s.length!==t);i=!0);}catch(c){l=!0,r=c}finally{try{i||null==n.return||n.return()}finally{if(l)throw r}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var T=function(){var e=(0,l.a)(),t=e.currentUser,n=e.delUser,f=e.reAuth,y=e.changePassword,k=(0,c.s)(),Z=k.getUser,w=(k.updateUser,k.updateListing,k.getListingByUser,(0,s.useRouter)()),C=O((0,o.r)(),2),P=(C[0],C[1]),S=(0,d.d)().callable,R=(0,u.i)().snackBar,z=(0,m.y)().uploadImg,E=(0,r.useState)(),L=E[0],T=E[1],B=(0,r.useState)(!1),F=B[0],M=B[1],D=(0,r.useState)(!1),J=D[0],V=D[1],H=(0,r.useState)(!1),X=H[0],$=H[1],q=(0,r.useState)(null),G=q[0],K=q[1],Q=(0,r.useState)(null),W=Q[0],Y=Q[1],ee=(0,r.useState)(""),te=ee[0],ne=ee[1],ae=(0,r.useState)({index:-1,open:!1}),re=ae[0],se=ae[1],ie=(0,r.useState)(!1),le=ie[0],ce=ie[1],oe=(0,r.useState)(!0),de=oe[0],ue=oe[1],me=(0,r.useState)(!0),he=me[0],fe=me[1],pe=(0,r.useRef)(),ve=(0,r.useRef)(),je=(0,r.useRef)(),xe=(0,r.useRef)(),Ne=(0,r.useRef)(),ge=(0,r.useRef)(),be=((0,r.useRef)(),(0,r.useRef)()),ye=(0,r.useRef)();(0,r.useEffect)((function(){t&&Z(t.uid).then((function(e){T(e),e.data().mainInfo.pfp&&ne(e.data().mainInfo.pfp)})).catch((function(e){console.log(e.message)}))}),[t]),(0,r.useEffect)((function(){L&&(pe.current.value=L.data().mainInfo.username,ve.current.value=L.data().contact.email,je.current.value=L.data().contact.phone.substr(4),xe.current.value=L.data().contact.socials.ig,Ne.current.value=L.data().contact.socials.fb,ce(!L.data().hiddenListing),fe("phone"!=L.data().contact.hidden),ue("email"!=L.data().contact.hidden))}),[L]);var ke=function(){var e=pe.current.value.trim(),n=ve.current.value.trim(),a=je.current.value.trim(),r=S("userUpdates-updateProfile"),s=he?de?"":"email":"phone";if(null!=e&&null!=n&&null!=a)if(e.length<=2)R("Pros\xedm, zadejte sv\xe9 opravdov\xe9 jm\xe9no.","error");else if(a.includes("+"))R("Pros\xedm zadejte \u010d\xedslo bez p\u0159edvolby");else if(a.length<9)R("Pros\xedm, zadejte sv\xe9 opravdov\xe9 telefonn\xed \u010d\xedslo.","error");else if(n.length<3)R("Pros\xedm, zadejte sv\u016fj opravdov\xfd email.","error");else if(Ze()){a=L.data().contact.phone.substr(0,4)+a,P(!0);var i={uid:t.uid,listingId:L.data().listing.id,userParams:{contact:{email:n,phone:a,hidden:s,socials:{fb:Ne.current.value,ig:xe.current.value}},hiddenListing:!le,"mainInfo.username":e},listingParams:{email:n,phone:a,fb:Ne.current.value,ig:xe.current.value,hiddenByUser:!le,hiddenContact:s}};r(JSON.stringify(i)).then((function(e){return W?z(t.uid,W,"pfp"):new Promise((function(e,t){e("completed")}))})).then((function(e){P(!1),w.back(),R("\xdaprava prob\u011bhla \xfasp\u011b\u0161n\u011b.","success")})).catch((function(e){console.log(e),P(!1),R("N\u011bco se nepovedlo. Zkuste to pros\xedm pozd\u011bji.","error")}))}else R("Pros\xedm, zadejte opravdov\xe9 odkazy na soci\xe1ln\xed sit\u011b.","error");else R("N\u011bkter\xe1 d\u016fle\u017eit\xe1 pole chyb\xed. Vypl\u0148te je pros\xedm.","error")},Ze=function(){var e=!1,t=!1;return""==!Ne.current.value?(Ne.current.value=Ne.current.value.trim(),Ne.current.value.includes("facebook.com")?(Ne.current.value.includes("https://")||(Ne.current.value="https://"+Ne.current.value),e=!0):e=!1):e=!0,""==!xe.current.value?(xe.current.value=xe.current.value.trim(),xe.current.value.includes("instagram.com")?(xe.current.value.includes("https://")||(xe.current.value="https://"+xe.current.value),t=!0):t=!1):t=!0,!(!e||!t)},we=function(){if(W)Y(null);else{P(!0);var e=S("images-deleteImgs"),n={url:te,uid:t.uid,listingId:L.data().listing.id};e(JSON.stringify(n)).then((function(e){ne(null),P(!1)})).catch((function(e){P(!1)}))}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.default,{children:(0,a.jsx)("title",{children:"Upravit profil | Roomie"})}),(0,a.jsxs)("div",{className:"EditProfile",children:[(0,a.jsx)(h.Z,{variant:"gradient"}),(0,a.jsxs)(N.Z,{open:F,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,a.jsx)(A.Z,{children:"Neulo\u017een\xe9 zm\u011bny"}),(0,a.jsx)(b.Z,{children:(0,a.jsx)(I,{children:"M\xe1te neulo\u017een\xe9 zm\u011bny. P\u0159ejete si pokra\u010dovat?"})}),(0,a.jsxs)(g.Z,{children:[(0,a.jsx)(U.Z,{onClick:function(){M(!1),w.back()},children:"Ano"}),(0,a.jsx)(U.Z,{onClick:function(){return M(!1)},children:"Ne"})]})]}),(0,a.jsxs)(N.Z,{open:J,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[G&&(0,a.jsx)(_.Z,{severity:"error",children:G}),(0,a.jsx)(A.Z,{children:"P\u0159ejete si smazat sv\u016fj \xfa\u010det?"}),(0,a.jsxs)(b.Z,{children:[(0,a.jsx)(I,{sx:{marginBottom:"16px"},children:"Potvr\u010fte pros\xedm sv\xe9 p\u0159ihla\u0161ovac\xed \xfadaje"}),(0,a.jsx)("input",{ref:be,style:{width:"100%"},type:"password",placeholder:"Heslo..."})]}),(0,a.jsxs)(g.Z,{children:[(0,a.jsx)(U.Z,{onClick:function(){console.log("DELETE"),P(!0),V(!1),f(t,be.current.value).then((function(e){return n(t)})).then((function(e){P(!1),w.push("/"),V(!1)})).catch((function(e){switch(V(!0),e.code){case"auth/wrong-password":K("Zadan\xe9 heslo nen\xed spr\xe1vn\xe9");break;default:K("N\u011bco se nepovedlo.")}P(!1)}))},children:"Smazat"}),(0,a.jsx)(U.Z,{onClick:function(){return V(!1)},children:"Ne"})]})]}),(0,a.jsxs)(N.Z,{open:X,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[G&&(0,a.jsx)(_.Z,{severity:"error",children:G}),(0,a.jsx)(A.Z,{children:"Pro zm\u011bnu hesla pros\xedm zadejte sv\xe9 st\xe1vaj\xedc\xed heslo."}),(0,a.jsxs)(b.Z,{children:[(0,a.jsx)(I,{sx:{marginBottom:"16px"},children:"Potvr\u010fte pros\xedm sv\xe9 p\u0159ihla\u0161ovac\xed \xfadaje"}),(0,a.jsx)("input",{ref:ye,style:{width:"100%"},type:"password",placeholder:"Heslo..."})]}),(0,a.jsxs)(g.Z,{children:[(0,a.jsx)(U.Z,{onClick:function(){P(!0),$(!1),f(t,ye.current.value).then((function(e){return y(t,ge.current.value)})).then((function(e){P(!1),ke()})).catch((function(e){switch($(!0),e.code){case"auth/wrong-password":K("Zadan\xe9 heslo nen\xed spr\xe1vn\xe9");break;case"auth/weak-password":K("Va\u0161e nov\xe9 heslo by m\u011blo m\xedt alespo\u0148 6 znak\u016f.");break;default:K("N\u011bco se nepovedlo.")}P(!1),console.log(e)}))},children:"Zm\u011bnit"}),(0,a.jsx)(U.Z,{onClick:function(){return $(!1)},children:"Ne"})]})]}),(0,a.jsx)(j.Z,{object:re,setObject:se,addedPfp:W,setAddedPfp:Y,pfp:te}),(0,a.jsx)("div",{className:"container",children:L?(0,a.jsxs)("div",{className:"edit-content",children:[(0,a.jsxs)("div",{className:"content-header",children:[L?(0,a.jsx)(a.Fragment,{children:W?(0,a.jsxs)("div",{className:"header-pfp",children:[(0,a.jsx)("img",{src:URL.createObjectURL(W),alt:""}),(0,a.jsx)("div",{className:"header-pfp-delete",children:(0,a.jsx)("i",{onClick:function(){return we()},className:"fas fa-trash"})})]}):(0,a.jsx)(a.Fragment,{children:te?(0,a.jsxs)("div",{className:"header-pfp",children:[(0,a.jsx)("img",{src:te,alt:""}),(0,a.jsx)("div",{className:"header-pfp-delete",children:(0,a.jsx)("i",{onClick:function(){return we()},className:"fas fa-trash"})})]}):(0,a.jsx)("div",{className:"header-pfp"})})}):(0,a.jsx)("div",{className:"header-pfp"}),(0,a.jsx)("h2",{className:"header-name",children:L.data().mainInfo.username}),(0,a.jsx)("a",{onClick:function(){return se({open:!0,index:-1})},className:"header-link",children:"Zm\u011bnit profilovou fotku"})]}),null!=W&&(0,a.jsxs)("div",{className:"edit-file-uploaded",children:[(0,a.jsx)("i",{className:"fas fa-check"}),(0,a.jsxs)("p",{className:"file-uploaded-description",children:["Soubor nahr\xe1n! (",W.name,")"]})]}),(0,a.jsxs)("div",{className:"content-form",children:[(0,a.jsxs)("div",{className:"form-item",children:[(0,a.jsx)("p",{className:"item-description",children:"Viditelnost profilu"}),(0,a.jsx)(p,{activeRider:le,setActiveRider:ce})]}),(0,a.jsx)("p",{className:"form-section-header",children:"Osobn\xed a p\u0159ihla\u0161ovac\xed \xfadaje"}),(0,a.jsxs)("div",{className:"form-item",children:[(0,a.jsx)("p",{className:"item-description",children:"Jm\xe9no"}),(0,a.jsx)("input",{disabled:!0,maxLength:15,ref:pe,type:"text",className:"item-input"})]}),(0,a.jsxs)("div",{className:"form-item",children:[(0,a.jsx)("p",{className:"item-description",children:"E-mail"}),(0,a.jsx)("input",{disabled:!0,maxLength:30,ref:ve,type:"text",className:"item-input"}),(0,a.jsx)("i",{onClick:function(){de&&!he?(ue(!1),fe(!0)):ue((function(e){return!e}))},style:{opacity:de?1:.5},className:"fas fa-eye"})]}),(0,a.jsxs)("div",{className:"form-item",children:[(0,a.jsx)("p",{className:"item-description",children:" Tel. \u010d\xedslo"}),(0,a.jsx)("input",{maxLength:9,ref:je,type:"text",className:"item-input"}),(0,a.jsx)("i",{onClick:function(){he&&!de?(fe(!1),ue(!0)):fe((function(e){return!e}))},style:{opacity:he?1:.5},className:"fas fa-eye"})]}),(0,a.jsx)("p",{className:"form-section-header",children:"Soci\xe1ln\xed s\xedt\u011b"}),(0,a.jsxs)("div",{className:"form-item",children:[(0,a.jsx)("p",{className:"item-description",children:"Instagram"}),(0,a.jsx)("input",{ref:xe,type:"text",className:"item-input"})]}),(0,a.jsxs)("div",{className:"form-item",children:[(0,a.jsx)("p",{className:"item-description",children:"Facebook"}),(0,a.jsx)("input",{ref:Ne,type:"text",className:"item-input"})]}),(0,a.jsx)("p",{className:"form-section-header",children:"\xda\u010det a zabezpe\u010den\xed"}),(0,a.jsxs)("div",{className:"form-item",children:[(0,a.jsx)("p",{className:"item-description",children:"Zm\u011bnit heslo"}),(0,a.jsx)("input",{maxLength:30,ref:ge,type:"password",placeholder:"Zadejte nov\xe9 heslo...",className:"item-input"})]})]}),(0,a.jsxs)("div",{className:"content-account-links",children:[(0,a.jsx)("a",{className:"links-deactivate",children:"do\u010dasn\u011b deaktivovat \xfa\u010det"}),(0,a.jsx)("a",{onClick:function(){return V(!0)},className:"links-delete",children:"smazat \xfa\u010det"})]}),(0,a.jsx)("div",{className:"content-btns",children:(0,a.jsx)("button",{onClick:function(){return ge.current.value?$(!0):ke()},className:"main-btn",children:"Ulo\u017eit zm\u011bny"})})]}):(0,a.jsx)("div",{className:"edit-loading",children:(0,a.jsx)(x.Z,{})})}),L&&(0,a.jsx)(v.Z,{})]})]})}}},function(e){e.O(0,[24,946,942,378,774,888,179],(function(){return t=1128,e(e.s=t);var t}));var t=e.O();_N_E=t}]);