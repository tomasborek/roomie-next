(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[46],{1128:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/edit-profile",function(){return n(3118)}])},3118:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var r=n(5893),s=n(7294),a=n(387),i=n(9008),l=n(1018),c=n(6934),o=n(5182),d=n(1614),u=n(7503),m=n(742),h=n(1681),f=n(5906),p=function(e){var t=e.activeRider,n=e.setActiveRider;return(0,r.jsx)("div",{onClick:function(){return n((function(e){return!e}))},className:"switcher",children:(0,r.jsx)(f.E.div,{variants:{active:{left:0,backgroundColor:"#309EAB"},disabled:{right:0,backgroundColor:"#E14949"},transition:{duration:.2}},animate:t?"active":"",initial:"disabled",transition:"transition",className:"switcher-rider",children:(0,r.jsx)(f.E.i,{animate:t?{rotate:"360deg"}:"",transition:{duration:.4},className:"fas fa-".concat(t?"check":"times")})})})},v=n(3300),j=n(378),x=n(8456),g=n(1587),N=n(1425),b=n(6580),y=n(3366),k=n(7462),Z=n(7192),w=n(2151),P=n(7623),C=n(8862),R=n(3620);function S(e){return(0,R.Z)("MuiDialogContentText",e)}(0,n(6087).Z)("MuiDialogContentText",["root"]);const z=["children"],E=(0,w.ZP)(C.Z,{shouldForwardProp:e=>(0,w.FO)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({});var I=s.forwardRef((function(e,t){const n=(0,P.Z)({props:e,name:"MuiDialogContentText"}),s=(0,y.Z)(n,z),a=(e=>{const{classes:t}=e,n=(0,Z.Z)({root:["root"]},S,t);return(0,k.Z)({},t,n)})(s);return(0,r.jsx)(E,(0,k.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:s},n,{classes:a}))})),A=n(7645),U=n(3321),_=n(5568);function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,s,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(c){l=!0,s=c}finally{try{i||null==n.return||n.return()}finally{if(l)throw s}}return a}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var T=function(){var e=(0,l.a)(),t=e.currentUser,n=e.delUser,f=e.reAuth,y=e.changePassword,k=(0,c.s)(),Z=k.getUser,w=(k.updateUser,k.updateListing,k.getListingByUser,(0,a.useRouter)()),P=O((0,o.r)(),2),C=(P[0],P[1]),R=(0,d.d)().callable,S=(0,u.i)().snackBar,z=(0,m.y)().uploadImg,E=(0,s.useState)(),L=E[0],T=E[1],B=(0,s.useState)(!1),F=B[0],M=B[1],D=(0,s.useState)(!1),J=D[0],V=D[1],H=(0,s.useState)(!1),X=H[0],$=H[1],q=(0,s.useState)(null),G=q[0],K=q[1],Q=(0,s.useState)(null),W=Q[0],Y=Q[1],ee=(0,s.useState)(""),te=ee[0],ne=ee[1],re=(0,s.useState)({index:-1,open:!1}),se=re[0],ae=re[1],ie=(0,s.useState)(!1),le=ie[0],ce=ie[1],oe=(0,s.useRef)(),de=(0,s.useRef)(),ue=(0,s.useRef)(),me=(0,s.useRef)(),he=(0,s.useRef)(),fe=(0,s.useRef)(),pe=((0,s.useRef)(),(0,s.useRef)()),ve=(0,s.useRef)();(0,s.useEffect)((function(){t&&Z(t.uid).then((function(e){T(e),e.data().mainInfo.pfp&&ne(e.data().mainInfo.pfp)})).catch((function(e){console.log(e.message)}))}),[t]),(0,s.useEffect)((function(){L&&(oe.current.value=L.data().mainInfo.username,de.current.value=L.data().contact.email,ue.current.value=L.data().contact.phone.substr(4),me.current.value=L.data().contact.socials.ig,he.current.value=L.data().contact.socials.fb,ce(!L.data().hiddenListing))}),[L]);var je=function(){var e=oe.current.value.trim(),n=de.current.value.trim(),r=ue.current.value.trim(),s=R("userUpdates-updateProfile");if(null!=e&&null!=n&&null!=r)if(e.length<=2)S("Pros\xedm, zadejte sv\xe9 opravdov\xe9 jm\xe9no.","error");else if(r.includes("+"))S("Pros\xedm zadejte \u010d\xedslo bez p\u0159edvolby");else if(r.length<9)S("Pros\xedm, zadejte sv\xe9 opravdov\xe9 telefonn\xed \u010d\xedslo.","error");else if(n.length<3)S("Pros\xedm, zadejte sv\u016fj opravdov\xfd email.","error");else if(xe()){r=L.data().contact.phone.substr(0,4)+r,C(!0);var a={uid:t.uid,listingId:L.data().listing.id,userParams:{contact:{email:n,phone:r,socials:{fb:he.current.value,ig:me.current.value}},hiddenListing:!le,"mainInfo.username":e},listingParams:{email:n,phone:r,fb:he.current.value,ig:me.current.value,hiddenByUser:!le}};s(JSON.stringify(a)).then((function(e){return W?z(t.uid,W,"pfp"):new Promise((function(e,t){e("completed")}))})).then((function(e){C(!1),w.back(),S("\xdaprava prob\u011bhla \xfasp\u011b\u0161n\u011b.","success")})).catch((function(e){console.log(e),C(!1),S("N\u011bco se nepovedlo. Zkuste to pros\xedm pozd\u011bji.","error")}))}else S("Pros\xedm, zadejte opravdov\xe9 odkazy na soci\xe1ln\xed sit\u011b.","error");else S("N\u011bkter\xe1 d\u016fle\u017eit\xe1 pole chyb\xed. Vypl\u0148te je pros\xedm.","error")},xe=function(){var e=!1,t=!1;return""==!he.current.value?(he.current.value=he.current.value.trim(),he.current.value.includes("facebook.com")?(he.current.value.includes("https://")||(he.current.value="https://"+he.current.value),e=!0):e=!1):e=!0,""==!me.current.value?(me.current.value=me.current.value.trim(),me.current.value.includes("instagram.com")?(me.current.value.includes("https://")||(me.current.value="https://"+me.current.value),t=!0):t=!1):t=!0,!(!e||!t)},ge=function(){if(W)Y(null);else{C(!0);var e=R("images-deleteImgs"),n={url:te,uid:t.uid,listingId:L.data().listing.id};e(JSON.stringify(n)).then((function(e){ne(null),C(!1)})).catch((function(e){C(!1)}))}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.default,{children:(0,r.jsx)("title",{children:"Upravit profil | Roomie"})}),(0,r.jsxs)("div",{className:"EditProfile",children:[(0,r.jsx)(h.Z,{variant:"gradient"}),(0,r.jsxs)(g.Z,{open:F,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,r.jsx)(A.Z,{children:"Neulo\u017een\xe9 zm\u011bny"}),(0,r.jsx)(b.Z,{children:(0,r.jsx)(I,{children:"M\xe1te neulo\u017een\xe9 zm\u011bny. P\u0159ejete si pokra\u010dovat?"})}),(0,r.jsxs)(N.Z,{children:[(0,r.jsx)(U.Z,{onClick:function(){M(!1),w.back()},children:"Ano"}),(0,r.jsx)(U.Z,{onClick:function(){return M(!1)},children:"Ne"})]})]}),(0,r.jsxs)(g.Z,{open:J,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[G&&(0,r.jsx)(_.Z,{severity:"error",children:G}),(0,r.jsx)(A.Z,{children:"P\u0159ejete si smazat sv\u016fj \xfa\u010det?"}),(0,r.jsxs)(b.Z,{children:[(0,r.jsx)(I,{sx:{marginBottom:"16px"},children:"Potvr\u010fte pros\xedm sv\xe9 p\u0159ihla\u0161ovac\xed \xfadaje"}),(0,r.jsx)("input",{ref:pe,style:{width:"100%"},type:"password",placeholder:"Heslo..."})]}),(0,r.jsxs)(N.Z,{children:[(0,r.jsx)(U.Z,{onClick:function(){console.log("DELETE"),C(!0),V(!1),f(t,pe.current.value).then((function(e){return n(t)})).then((function(e){C(!1),w.push("/"),V(!1)})).catch((function(e){switch(V(!0),e.code){case"auth/wrong-password":K("Zadan\xe9 heslo nen\xed spr\xe1vn\xe9");break;default:K("N\u011bco se nepovedlo.")}C(!1)}))},children:"Smazat"}),(0,r.jsx)(U.Z,{onClick:function(){return V(!1)},children:"Ne"})]})]}),(0,r.jsxs)(g.Z,{open:X,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[G&&(0,r.jsx)(_.Z,{severity:"error",children:G}),(0,r.jsx)(A.Z,{children:"Pro zm\u011bnu hesla pros\xedm zadejte sv\xe9 st\xe1vaj\xedc\xed heslo."}),(0,r.jsxs)(b.Z,{children:[(0,r.jsx)(I,{sx:{marginBottom:"16px"},children:"Potvr\u010fte pros\xedm sv\xe9 p\u0159ihla\u0161ovac\xed \xfadaje"}),(0,r.jsx)("input",{ref:ve,style:{width:"100%"},type:"password",placeholder:"Heslo..."})]}),(0,r.jsxs)(N.Z,{children:[(0,r.jsx)(U.Z,{onClick:function(){C(!0),$(!1),f(t,ve.current.value).then((function(e){return y(t,fe.current.value)})).then((function(e){C(!1),je()})).catch((function(e){switch($(!0),e.code){case"auth/wrong-password":K("Zadan\xe9 heslo nen\xed spr\xe1vn\xe9");break;case"auth/weak-password":K("Va\u0161e nov\xe9 heslo by m\u011blo m\xedt alespo\u0148 6 znak\u016f.");break;default:K("N\u011bco se nepovedlo.")}C(!1),console.log(e)}))},children:"Zm\u011bnit"}),(0,r.jsx)(U.Z,{onClick:function(){return $(!1)},children:"Ne"})]})]}),(0,r.jsx)(j.Z,{object:se,setObject:ae,addedPfp:W,setAddedPfp:Y,pfp:te}),(0,r.jsx)("div",{className:"container",children:L?(0,r.jsxs)("div",{className:"edit-content",children:[(0,r.jsxs)("div",{className:"content-header",children:[L?(0,r.jsx)(r.Fragment,{children:W?(0,r.jsxs)("div",{className:"header-pfp",children:[(0,r.jsx)("img",{src:URL.createObjectURL(W),alt:""}),(0,r.jsx)("div",{className:"header-pfp-delete",children:(0,r.jsx)("i",{onClick:function(){return ge()},className:"fas fa-trash"})})]}):(0,r.jsx)(r.Fragment,{children:te?(0,r.jsxs)("div",{className:"header-pfp",children:[(0,r.jsx)("img",{src:te,alt:""}),(0,r.jsx)("div",{className:"header-pfp-delete",children:(0,r.jsx)("i",{onClick:function(){return ge()},className:"fas fa-trash"})})]}):(0,r.jsx)("div",{className:"header-pfp"})})}):(0,r.jsx)("div",{className:"header-pfp"}),(0,r.jsx)("h2",{className:"header-name",children:L.data().mainInfo.username}),(0,r.jsx)("a",{onClick:function(){return ae({open:!0,index:-1})},className:"header-link",children:"Zm\u011bnit profilovou fotku"})]}),null!=W&&(0,r.jsxs)("div",{className:"edit-file-uploaded",children:[(0,r.jsx)("i",{className:"fas fa-check"}),(0,r.jsxs)("p",{className:"file-uploaded-description",children:["Soubor nahr\xe1n! (",W.name,")"]})]}),(0,r.jsxs)("div",{className:"content-form",children:[(0,r.jsxs)("div",{className:"form-item",children:[(0,r.jsx)("p",{className:"item-description",children:"Viditelnost profilu"}),(0,r.jsx)(p,{activeRider:le,setActiveRider:ce})]}),(0,r.jsx)("p",{className:"form-section-header",children:"Osobn\xed a p\u0159ihla\u0161ovac\xed \xfadaje"}),(0,r.jsxs)("div",{className:"form-item",children:[(0,r.jsx)("p",{className:"item-description",children:"Jm\xe9no"}),(0,r.jsx)("input",{disabled:!0,maxLength:15,ref:oe,type:"text",className:"item-input"})]}),(0,r.jsxs)("div",{className:"form-item",children:[(0,r.jsx)("p",{className:"item-description",children:"E-mail"}),(0,r.jsx)("input",{disabled:!0,maxLength:30,ref:de,type:"text",className:"item-input"})]}),(0,r.jsxs)("div",{className:"form-item",children:[(0,r.jsx)("p",{className:"item-description",children:" Tel. \u010d\xedslo"}),(0,r.jsx)("input",{maxLength:9,ref:ue,type:"text",className:"item-input"})]}),(0,r.jsx)("p",{className:"form-section-header",children:"Soci\xe1ln\xed s\xedt\u011b"}),(0,r.jsxs)("div",{className:"form-item",children:[(0,r.jsx)("p",{className:"item-description",children:"Instagram"}),(0,r.jsx)("input",{ref:me,type:"text",className:"item-input"})]}),(0,r.jsxs)("div",{className:"form-item",children:[(0,r.jsx)("p",{className:"item-description",children:"Facebook"}),(0,r.jsx)("input",{ref:he,type:"text",className:"item-input"})]}),(0,r.jsx)("p",{className:"form-section-header",children:"\xda\u010det a zabezpe\u010den\xed"}),(0,r.jsxs)("div",{className:"form-item",children:[(0,r.jsx)("p",{className:"item-description",children:"Zm\u011bnit heslo"}),(0,r.jsx)("input",{maxLength:30,ref:fe,type:"password",placeholder:"Zadejte nov\xe9 heslo...",className:"item-input"})]})]}),(0,r.jsxs)("div",{className:"content-account-links",children:[(0,r.jsx)("a",{className:"links-deactivate",children:"do\u010dasn\u011b deaktivovat \xfa\u010det"}),(0,r.jsx)("a",{onClick:function(){return V(!0)},className:"links-delete",children:"smazat \xfa\u010det"})]}),(0,r.jsx)("div",{className:"content-btns",children:(0,r.jsx)("button",{onClick:function(){return fe.current.value?$(!0):je()},className:"main-btn",children:"Ulo\u017eit zm\u011bny"})})]}):(0,r.jsx)("div",{className:"edit-loading",children:(0,r.jsx)(x.Z,{})})}),L&&(0,r.jsx)(v.Z,{})]})]})}}},function(e){e.O(0,[24,855,942,378,774,888,179],(function(){return t=1128,e(e.s=t);var t}));var t=e.O();_N_E=t}]);